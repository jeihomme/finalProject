<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="web.dao.face.MemberDao">

 	<insert id="insertUser" parameterType="web.dto.Member">
 		INSERT INTO member (userId, roleId, password, email, telcom, contact, userName)
 		VALUES ( #{userId }, #{roleId }, #{password }, #{email }, #{telcom }, #{contact }, #{userName })
 	</insert>
 	
 	<insert id="insertBar" parameterType="web.dto.Bar">
 		INSERT INTO bar (barNo, barName, userId, profileNo, locationNo, barInfo, manager, contact, barAddress, genreNo)
 		VALUES ( barNo_seq.nextval, #{barName }, #{userId }, profileNo_seq.nextval, locationNo_seq.nextval, #{barInfo }, #{manager }, #{contact }, #{barAddress }, #{genreNo })
 	</insert>
 	
 	<insert id="insertBand" parameterType="web.dto.Band">
 		INSERT INTO band (bandNo, bandName, userId, profileNo)
 		VALUES ( band_seq.nextval, #{bandName }, #{userId }, profileNo_seq.nextval)
 	</insert>
 	
 	<select id="checkJoinId" parameterType="web.dto.Member" resultType="int">
 		SELECT COUNT(*)
 		FROM member
 		WHERE 1=1
 			AND userId=#{userId }
 	</select>
 	
 	<select id="checkJoinUserName" parameterType="web.dto.Member" resultType="int">
 		SELECT COUNT(*)
 		FROM member
 		WHERE 1=1
 			AND userName=#{userName }
 	</select>
 	
 	<select id="selectCntLogin" parameterType="web.dto.Member" resultType="int">
 		SELECT COUNT(*) CNT
 		FROM member
 		WHERE 1=1
 		
 			<if test="userId != null and userId != ''">
 				AND userId=#{userId }
 			</if>
 			<if test="password != null and password != ''">
 				AND password=#{password }
 			</if>
 	</select>
 	
 	<select id="checkLoginInfo" parameterType="web.dto.Member" resultType="web.dto.Member">
 		SELECT
 			userId,
 			roleId,
 			password,
 			email,
 			telcom,
 			contact,
 			userName
 		FROM member
 		WHERE userId=#{userId }
 			AND password=#{password }
 	</select>
 	
 	<select id="selectUserId" parameterType="web.dto.Member" resultType="int">
 		SELECT userId
 		FROM member
 		WHERE email=#{email } 
 	</select>
 	
 	<select id="selectUserPw" parameterType="web.dto.Member" resultType="int">
 		SELECT password
 		FROM member
 		WHERE email=#{email }
 			AND userId=#{userId }
 	</select>
 	
 	<select id="selectRoleId" parameterType="web.dto.Member" resultType="int">
 		SELECT roleId
 		FROM member
 		WHERE userId=#{userId }
 			AND password=#{password }
 	</select>
 	
 </mapper>